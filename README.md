# Stocks-Analysis

### Overview of Project
Steve sought me out to create an excel macro to run an analysis on 12 different stocks over the years 2017 and 2018 to see which stocks were worth investing in. After creating the macro, Steve told me that his parents were going to use the macro to look at many other stocks and their returns. In order to please his parents, I wanted to refactor the code so that it ran a little smoother and a bit quicker.

### Results
For the year 2017, we can see that most stocks did really well. With stocks like 'DQ' and 'SEDG' with almost 200% returns in the first year.
However, when we look at 2018 data; we can see that some of those stocks that skyrocketed... they turned around and nose dived. Adding on to this, we can see that the stocks 'SPWR', 'JKS', and 'FSLR' could be seen as "Highly Volatile" stocks because of their difference in % Returns over the course of the 2 years and the sheer amount of daily volume that is being traded.
The true "Winner" out of the 12 stocks is 'ENPH', with returns of over 200% for a 2 year period of time and coming in a close 2nd place would be 'RUN' with returns of only 89.5% in the 2 years, however, 84% came from the year 2018. It's possible we could see 'RUN' have an even bigger year coming up in year 3. If you wanted a 3rd option out of the list to invest in, my 3rd and final choice would be 'SEDG' with returns of 176.7% over the course of the 2 years, and only declining by 7.8% in year 2. 

![All_Stocks_2017](https://user-images.githubusercontent.com/69607218/131585094-903bddd5-451f-4a92-bdd5-ef4f28843ff6.png)![All_Stocks_2018](https://user-images.githubusercontent.com/69607218/131585110-2e191541-c35f-46a7-9baa-06a783e6d786.png)

Now these results could have been generated by the original program or the refactored one. The differences between the two is that the refactored one has a lot cleaner of processes to get the same result. The cleaner the processes are, the quicker and more efficient the computer can run the program. As you can see below, the difference in the code may be subtle but it can make a huge impact on how the program is run. The steps for each line of code are written with a (') at the start of each sentence and provide a guideline or order of events for writing the code.

#### Original Code
        
    'Loop through the tickers.
    
    For i = 0 To 11
        
        ticker = tickers(i)
        totalVolume = 0
    
    'Loop through rows in the data.
    
        Sheets(yearValue).Activate
    
        For j = 2 To RowCount
        
        '-Find the total volume for the current ticker.
        
        If Cells(j, 1).Value = ticker Then
            
            totalVolume = totalVolume + Cells(j, 8).Value
            
        End If
        
        '-Find the starting price for the current ticker.
        
        If Cells(j - 1, 1).Value <> ticker And Cells(j, 1).Value = ticker Then
            
            startingPrice = Cells(j, 6).Value
            
        End If
        
        '-Find the ending price for the current ticker.
        
        If Cells(j + 1, 1).Value <> ticker And Cells(j, 1).Value = ticker Then
            
            endingPrice = Cells(j, 6).Value
            
        End If
        
        Next j

#### Refactored Code
    
    '1a) Create a ticker Index
    
    tickerIndex = 0

    '1b) Create three output arrays
    
    Dim tickerVolumes(12) As Long
    Dim tickerStartingPrices(12) As Single
    Dim tickerEndingPrices(12) As Single
        
    '2a) Create a for loop to initialize the tickerVolumes to zero.
    
    For i = 0 To 11
        tickerVolumes(i) = 0
        tickerStartingPrices(i) = 0
        tickerEndingPrices(i) = 0
    
    Next i
                
     '2b) Loop over all the rows in the spreadsheet.
    
    For i = 2 To RowCount
    
     '3a) Increase volume for current ticker
        
        tickerVolumes(tickerIndex) = tickerVolumes(tickerIndex) + Cells(i, 8).Value
        
     '3b) Check if the current row is the first row with the selected tickerIndex.
        
        If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i - 1, 1).Value <> tickers(tickerIndex) Then
            tickerStartingPrices(tickerIndex) = Cells(i, 6).Value
                        
        End If
        
     '3c) check if the current row is the last row with the selected ticker
         'If the next row’s ticker doesn’t match, increase the tickerIndex.
         
         If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i + 1, 1).Value <> tickers(tickerIndex) Then
            tickerEndingPrices(tickerIndex) = Cells(i, 6).Value
            
        End If
            
     '3d Increase the tickerIndex.
        
        If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i + 1, 1).Value <> tickers(tickerIndex) Then
                tickerIndex = tickerIndex + 1
                
        End If
    
    Next i

### Summary
#### Advantages & Disadvantages to Refactoring Code
There are many reasons why you would want to refactor the code you're working with. There are multiple advantages to doing so; however, there are some disadvantages that you will want to watch out for.

###### Advantages:

    - It improves the design of the software
    - Helps the program run faster
    - Makes the code easier to understand for someone else reading it
    
###### Disadvantages:

    - It could introduce bugs, especially if there is a large amount of code or the code is difficult to understand.
    - It can be expensive.
    
#### Advantages and Disadvantages: Original vs. Refactored VBA Code
When it comes to the code that we wrote for Steve and his parents, the original code will work just fine. However, we wanted to create a more clear and concise program for the computer so that it could execute the program a bit more quickly. The advantages to our Refactored code is that we were able to significantly decrease the time it takes the computer to run the program. As you can see below, on the left we have the time it took the computer to execute the Original VBA program and on the right is the how long it took the Refactored code.

![Original_VBA_Code_Timer](https://user-images.githubusercontent.com/69607218/131920388-f0591e13-7cd0-41d0-9736-90001777f345.png)
![VBA_Challenge_2018](https://user-images.githubusercontent.com/69607218/131920402-d73cc0dc-f614-414d-9b66-1f67194a19f1.png)

All in all, the Original code that we wrote for Steve would have done a great job for what his parents needs were too. Our biggest disadvantages to the Refactored code is how long it took to refactor the code to save 0.5 seconds, and from an outside view the code is a little bit more confusing to understand with the syntax that was replaced. Overall the time invested to refactor the code for the time saved is not worth the investment, when the Original code could have done the job.

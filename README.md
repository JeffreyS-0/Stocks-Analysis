# Stocks-Analysis

### Overview of Project
Steve sought me out to create an excel macro to run an analysis on 12 different stocks over the years 2017 and 2018 to see which stocks were worth investing in. After creating the macro, Steve told me that his parents wanted to use the macro to run the same analysis but for thousands of other stocks. In order to give them a functional program, I needed to refactor the current code to run more efficiently.

### Results
For the year 2017, we can see that most stocks did really well. However, we have a few stocks that blew the rest out of the water! 
However, when we look at 2018 data; we can see that some of those stocks that skyrocketed... they turned around and nose dived.
The true "Winner" out of the 12 stocks is 'ENPH', with an increase of over 200% returns for a 2 year period of time. 

![All_Stocks_2017](https://user-images.githubusercontent.com/69607218/131585094-903bddd5-451f-4a92-bdd5-ef4f28843ff6.png)![All_Stocks_2018](https://user-images.githubusercontent.com/69607218/131585110-2e191541-c35f-46a7-9baa-06a783e6d786.png)

Now these results could have been generated by the original program or the refactored one. The differences between the two is that the refactored one has a lot cleaner of processes to get the same result. The cleaner the processes are, the quicker and more efficient the computer can run the program. As you can see below, the difference in the code may be subtle but it can make a huge impact on how the program is run. The steps for each line of code are written with a (') at the start of each sentence and provide a guideline or order of events for writing the code.


#### Original



    'Prepare for the analysis of tickers.
        '-Initialize variables for the starting price and ending price.
        
    Dim startingPrice As Single
    Dim endingPrice As Single
    
        '- Activate the data worksheet.
        
    Sheets(yearValue).Activate
    
        '-Find the number of rows to loop over.
        
    RowCount = Cells(Rows.Count, "A").End(xlUp).Row
        
    'Loop through the tickers.
    
    For i = 0 To 11
        
        ticker = tickers(i)
        totalVolume = 0
    
    'Loop through rows in the data.
    
        Sheets(yearValue).Activate
    
        For j = 2 To RowCount
        
        '-Find the total volume for the current ticker.
        
        If Cells(j, 1).Value = ticker Then
            
            totalVolume = totalVolume + Cells(j, 8).Value
            
        End If
        
        '-Find the starting price for the current ticker.
        
        If Cells(j - 1, 1).Value <> ticker And Cells(j, 1).Value = ticker Then
            
            startingPrice = Cells(j, 6).Value
            
        End If
        
        '-Find the ending price for the current ticker.
        
        If Cells(j + 1, 1).Value <> ticker And Cells(j, 1).Value = ticker Then
            
            endingPrice = Cells(j, 6).Value
            
        End If
        
        Next j
        
    'Output the data for the current ticker.
    
    Worksheets("All Stocks Analysis").Activate
    Cells(4 + i, 1).Value = ticker
    Cells(4 + i, 2).Value = totalVolume
    Cells(4 + i, 3).Value = (endingPrice / startingPrice) - 1
       
    Next i
    
    endTime = Timer
    MsgBox "This code ran in " & (endTime - startTime) & " seconds for the year " & (yearValue)
    


#### Refactored


    
    'Activate data worksheet
    Worksheets(yearValue).Activate
    
    'Get the number of rows to loop over
    RowCount = Cells(Rows.Count, "A").End(xlUp).Row
    
    '1a) Create a ticker Index
    tickerIndex = 0

    '1b) Create three output arrays
    Dim tickerVolumes(12) As Long
    Dim tickerStartingPrices(12) As Single
    Dim tickerEndingPrices(12) As Single
    
    
    ''2a) Create a for loop to initialize the tickerVolumes to zero.
    For i = 0 To 11
        tickerVolumes(i) = 0
        tickerStartingPrices(i) = 0
        tickerEndingPrices(i) = 0
    
    Next i
                
    ''2b) Loop over all the rows in the spreadsheet.
    For i = 2 To RowCount
    
        '3a) Increase volume for current ticker
        tickerVolumes(tickerIndex) = tickerVolumes(tickerIndex) + Cells(i, 8).Value
        
        '3b) Check if the current row is the first row with the selected tickerIndex.
        'If  Then
        If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i - 1, 1).Value <> tickers(tickerIndex) Then
            tickerStartingPrices(tickerIndex) = Cells(i, 6).Value
                        
        End If
        
        'End If
        
        '3c) check if the current row is the last row with the selected ticker
         'If the next row’s ticker doesn’t match, increase the tickerIndex.
        'If  Then
         If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i + 1, 1).Value <> tickers(tickerIndex) Then
            tickerEndingPrices(tickerIndex) = Cells(i, 6).Value
            
        End If
            
        '3d Increase the tickerIndex.
        If Cells(i, 1).Value = tickers(tickerIndex) And Cells(i + 1, 1).Value <> tickers(tickerIndex) Then
                tickerIndex = tickerIndex + 1
                
        End If
            
        'End If
    
    Next i
    
    '4) Loop through your arrays to output the Ticker, Total Daily Volume, and Return.
    For i = 0 To 11
        
        Worksheets("All Stocks Analysis").Activate
        Cells(4 + i, 1).Value = tickers(i)
        Cells(4 + i, 2).Value = tickerVolumes(i)
        Cells(4 + i, 3).Value = (tickerEndingPrices(i) / tickerStartingPrices(i)) - 1
                
    Next i

### Summary
#### Advantages & Disadvantages to Refactoring Code
